
install argo

kubectl create ns argocd
curl -sSfL https://raw.githubusercontent.com/argoproj/argo-cd/stable/manifests/install.yaml | kubectl apply -n argocd -f -

get secret
kubectl -n argocd get secret argocd-initial-admin-secret -o jsonpath="{.data.password}" | base64 -d; echo

argocd login
argocd account update-password

install simple-app
argocd app create simple-app \
    --repo https://github.com/radmgrp/argo-example.git \
    --path simple-app \
    --dest-server https://kubernetes.default.svc \
    --dest-namespace argoapps

argocd app sync simple-app


Blue-Green Deployment with Argo

install rollouts

kubectl create namespace argo-rollouts
kubectl apply -n argo-rollouts -f https://github.com/argoproj/argo-rollouts/releases/latest/download/install.yaml

argocd app create --name blue-green \
    --repo https://github.com/argoproj/argocd-example-apps \
    --dest-server https://kubernetes.default.svc \
    --dest-namespace argoapps \
    --path blue-green && \
    argocd app sync blue-green

argocd app set blue-green -p image.tag=0.2 && argocd app sync blue-green
argocd app patch-resource blue-green \
    --kind Rollout \
    --resource-name blue-green-helm-guestbook \
    --patch '{ "status": { "verifyingPreview": false } }' \
    --patch-type 'application/merge-patch+json'

TODO
Helm for Argo
https://github.com/argoproj/argo-helm/tree/main/charts/argo-cd

SSH
ssh-keygen -t ed25519 -C "radmgrp@gmail.com"